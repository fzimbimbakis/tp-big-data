{
	"name": "Transformacion",
	"properties": {
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "onboardingPreProcessed",
						"type": "DatasetReference"
					},
					"name": "onboardingPreprocessed"
				},
				{
					"dataset": {
						"referenceName": "usersPreProcessed",
						"type": "DatasetReference"
					},
					"name": "usersPreprocessed"
				},
				{
					"dataset": {
						"referenceName": "transactionsPreProcessed",
						"type": "DatasetReference"
					},
					"name": "transactionsPreprocessed"
				}
			],
			"sinks": [],
			"transformations": [
				{
					"name": "join1"
				}
			],
			"scriptLines": [
				"source(output(",
				"          first_login_dt as date 'yyyy-MM-dd',",
				"          user_id as string,",
				"          habito as integer,",
				"          habito_dt as date 'yyyy-MM-dd',",
				"          activacion as integer,",
				"          activacion_dt as date 'yyyy-MM-dd',",
				"          setup as integer,",
				"          setup_dt as date 'yyyy-MM-dd',",
				"          return as integer,",
				"          return_dt as date 'yyyy-MM-dd'",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     ignoreNoFilesFound: false,",
				"     wildcardPaths:['onboardingClean']) ~> onboardingPreprocessed",
				"source(output(",
				"          MLB410638994850 as string",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     ignoreNoFilesFound: false) ~> usersPreprocessed",
				"source(output(",
				"          MLB410542856680 as string,",
				"          {9} as integer,",
				"          {2022-01-20} as date 'yyyy-MM-dd',",
				"          {2} as integer",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     ignoreNoFilesFound: false) ~> transactionsPreprocessed",
				"onboardingPreprocessed, usersPreprocessed join(user_id == MLB410638994850,",
				"     joinType:'inner',",
				"     matchType:'exact',",
				"     ignoreSpaces: false,",
				"     broadcast: 'auto')~> join1"
			]
		}
	}
}